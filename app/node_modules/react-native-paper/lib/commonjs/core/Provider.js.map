{"version":3,"sources":["Provider.tsx"],"names":["Provider","React","Component","reduceMotionEnabled","colorScheme","getColorScheme","preferences","setState","theme","providedTheme","props","state","DarkTheme","DefaultTheme","animation","scale","AccessibilityInfo","isReduceMotionEnabled","err","console","warn","componentDidMount","addEventListener","updateReduceMotionSettingsInfo","Appearance","addChangeListener","handleAppearanceChange","componentWillUnmount","removeEventListener","removeChangeListener","render","children","settings","icon","MaterialCommunityIcon","getTheme"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;AAae,MAAMA,QAAN,SAAuBC,KAAK,CAACC,SAA7B,CAAqD;AAAA;AAAA;;AAAA,mCAC1D;AACNC,MAAAA,mBAAmB,EAAE,KADf;AAENC,MAAAA,WAAW,EAAE,2GAAYC,cAAZ,OAAgC;AAFvC,KAD0D;;AAAA,oDAwBhEC,WAD+B,IAE5B;AACH,YAAM;AAAEF,QAAAA;AAAF,UAAkBE,WAAxB;AACA,WAAKC,QAAL,CAAc;AAAEH,QAAAA;AAAF,OAAd;AACD,KA5BiE;;AAAA,sCA8B/C,MAAM;AACvB,YAAM;AAAEI,QAAAA,KAAK,EAAEC;AAAT,UAA2B,KAAKC,KAAtC;AACA,YAAM;AAAEP,QAAAA,mBAAF;AAAuBC,QAAAA;AAAvB,UAAuC,KAAKO,KAAlD;;AAEA,UAAIF,aAAJ,EAAmB;AACjB,eAAOA,aAAP;AACD,OAFD,MAEO;AACL,cAAMD,KAAK,GAAIJ,WAAW,KAAK,MAAhB,GACXQ,kBADW,GAEXC,qBAFJ;AAIA,+CACKL,KADL;AAEEM,UAAAA,SAAS,kCACJN,KAAK,CAACM,SADF;AAEPC,YAAAA,KAAK,EAAEZ,mBAAmB,GAAG,CAAH,GAAO;AAF1B;AAFX;AAOD;AACF,KAjDiE;;AAAA,4DAmDzB,YAAY;AACnD,UAAI;AACF,cAAMA,mBAAmB,GAAG,MAAMa,+BAAkBC,qBAAlB,EAAlC;AAEA,aAAKV,QAAL,CAAc;AAAEJ,UAAAA;AAAF,SAAd;AACD,OAJD,CAIE,OAAOe,GAAP,EAAY;AACZC,QAAAA,OAAO,CAACC,IAAR,CAAaF,GAAb;AACD;AACF,KA3DiE;AAAA;;AAMlE,QAAMG,iBAAN,GAA0B;AACxBL,mCAAkBM,gBAAlB,CACE,qBADF,EAEE,KAAKC,8BAFP;;AAIA,SAAKA,8BAAL;AACAC,8GAAYC,iBAAZ,CAA8B,KAAKC,sBAAnC;AACD;;AAEDC,EAAAA,oBAAoB,GAAG;AACrBX,mCAAkBY,mBAAlB,CACE,qBADF,EAEE,KAAKL,8BAFP;;AAIAC,8GAAYK,oBAAZ,CAAiC,KAAKH,sBAAtC;AACD;;AAwCDI,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,QAAyB,KAAKtB,KAApC;AAEA,wBACE,oBAAC,mBAAD,qBACE,oBAAC,kBAAD;AAAkB,MAAA,KAAK,EAAEsB,QAAQ,IAAI;AAAEC,QAAAA,IAAI,EAAEC;AAAR;AAArC,oBACE,oBAAC,sBAAD;AAAe,MAAA,KAAK,EAAE,KAAKC,QAAL;AAAtB,OAAwCJ,QAAxC,CADF,CADF,CADF;AAOD;;AAvEiE","sourcesContent":["import * as React from 'react';\nimport { AccessibilityInfo, Appearance, ColorSchemeName } from 'react-native';\nimport { ThemeProvider } from './theming';\nimport { Provider as SettingsProvider, Settings } from './settings';\nimport MaterialCommunityIcon from '../components/MaterialCommunityIcon';\nimport PortalHost from '../components/Portal/PortalHost';\nimport DefaultTheme from '../styles/DefaultTheme';\nimport DarkTheme from '../styles/DarkTheme';\n\ntype Props = {\n  children: React.ReactNode;\n  theme?: ReactNativePaper.Theme;\n  settings?: Settings;\n};\n\ntype State = {\n  colorScheme: ColorSchemeName;\n  reduceMotionEnabled: boolean;\n};\n\nexport default class Provider extends React.Component<Props, State> {\n  state = {\n    reduceMotionEnabled: false,\n    colorScheme: Appearance?.getColorScheme() || 'light',\n  };\n\n  async componentDidMount() {\n    AccessibilityInfo.addEventListener(\n      'reduceMotionChanged',\n      this.updateReduceMotionSettingsInfo\n    );\n    this.updateReduceMotionSettingsInfo();\n    Appearance?.addChangeListener(this.handleAppearanceChange);\n  }\n\n  componentWillUnmount() {\n    AccessibilityInfo.removeEventListener(\n      'reduceMotionChanged',\n      this.updateReduceMotionSettingsInfo\n    );\n    Appearance?.removeChangeListener(this.handleAppearanceChange);\n  }\n\n  private handleAppearanceChange = (\n    preferences: Appearance.AppearancePreferences\n  ) => {\n    const { colorScheme } = preferences;\n    this.setState({ colorScheme });\n  };\n\n  private getTheme = () => {\n    const { theme: providedTheme } = this.props;\n    const { reduceMotionEnabled, colorScheme } = this.state;\n\n    if (providedTheme) {\n      return providedTheme;\n    } else {\n      const theme = (colorScheme === 'dark'\n        ? DarkTheme\n        : DefaultTheme) as ReactNativePaper.Theme;\n\n      return {\n        ...theme,\n        animation: {\n          ...theme.animation,\n          scale: reduceMotionEnabled ? 0 : 1,\n        },\n      };\n    }\n  };\n\n  private updateReduceMotionSettingsInfo = async () => {\n    try {\n      const reduceMotionEnabled = await AccessibilityInfo.isReduceMotionEnabled();\n\n      this.setState({ reduceMotionEnabled });\n    } catch (err) {\n      console.warn(err);\n    }\n  };\n\n  render() {\n    const { children, settings } = this.props;\n\n    return (\n      <PortalHost>\n        <SettingsProvider value={settings || { icon: MaterialCommunityIcon }}>\n          <ThemeProvider theme={this.getTheme()}>{children}</ThemeProvider>\n        </SettingsProvider>\n      </PortalHost>\n    );\n  }\n}\n"]}